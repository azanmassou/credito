const a=new URL(location.href),n="https://gestion.servy.es/api/leads/check/status";function h(){const e=new URLSearchParams;let c=0,i=!0;e.set("welcome",1),e.set("email",a.searchParams.get("email")||""),e.set("service_id",a.searchParams.get("service_id")||""),e.set("class",a.searchParams.get("class")||""),e.set("qty",a.searchParams.get("qty")||""),e.set("product",a.searchParams.get("product")||""),e.set("name",a.searchParams.get("name")||"");let r="comparador.php?"+e.toString();if(a.searchParams.get("product")!=="")switch(a.searchParams.get("product")){case"hipoteca":r="comparador-hipotecas.php?"+e.toString();break;case"tarjeta de crÃ©dito":r="comparador-tarjetas.php?"+e.toString();break;case"cuenta":r="comparador-cuentas.php?"+e.toString();break;case"reunificacion":r="https://gestion.servy.es/services/thankyou-pages/11?"+e.toString();break}let o;(!a.searchParams.get("email")||!a.searchParams.get("service_id"))&&(window.location.href=r),o=setInterval(()=>{c++;const s=new URL(n);s.searchParams.set("email",a.searchParams.get("email")),s.searchParams.set("service_id",a.searchParams.get("service_id")),s.searchParams.set("last_try",c==10?1:0),i&&(i=!1,fetch(s.toString()).then(function(t){if(t.ok)return t.json();throw{code:t.status}}).then(function(t){window.location.href=t,clearInterval(o)}).catch(function(t){if([425,404].includes(t.code)&&c<10){i=!0;return}clearInterval(o),window.location.href=r}))},6e3)}(function(){h()})();
